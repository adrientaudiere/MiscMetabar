---
title: "Tree visualization"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{tree_visualization}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: bibliography.bib
---

```{r}
library("treeio")
library("ggtree")
ggtree(ps_tree@phy_tree, layout = "ellipse") + geom_tiplab()
ggtree(as.treedata(df_tree$ML), layout = "slanted")
ggdensitree(df_tree$ML_bs, alpha = .3, colour = "steelblue") +
  geom_tiplab(size = 3) + hexpand(.35)
ggtree(as.treedata(df_tree$ML)) +
  geom_text(aes(x = branch, label = AA_subs, vjust = -.5), size = 1)
tax_tab <- as_tibble(ps_tree@tax_table) %>%
  mutate(.otu = as.character(.otu))
p <- ggtree(as.treedata(ps_tree@phy_tree)) %<+% as_tibble(ps_tree@tax_table)
p + geom_tippoint(aes(color = Class, shape = Phylum)) +
  geom_text(aes(label = Genus), hjust = -0.2, size = 2)
ggtree(as.treedata(ps_tree@phy_tree), branch.length = "none") %<+%
  as_tibble(ps_tree@tax_table) +
  geom_tippoint(aes(color = Class, shape = Phylum), size = 2)
```