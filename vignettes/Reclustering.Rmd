---
title: "Reclustering"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Reclustering}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(MiscMetabar)
```

# Re-clustering ASVs

## Using decipher or Vsearch algorithm
```{r}
data(data_fungi_sp_known)
otu <- asv2otu(data_fungi_sp_known, method = "clusterize")
otu_vs <- asv2otu(data_fungi_sp_known, method = "vsearch")
```

```{r}
summary_plot_pq(data_fungi_sp_known)
summary_plot_pq(otu)
summary_plot_pq(otu_vs)
```

## Using lulu algorithm (https://www.nature.com/articles/s41467-017-01312-x)

```{r, message=FALSE}
data(data_fungi_sp_known)
lulu_res <- lulu_pq(data_fungi_sp_known)
```

```{r}
summary_plot_pq(data_fungi_sp_known)
summary_plot_pq(lulu_res$new_physeq)
```
