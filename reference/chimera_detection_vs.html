<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content=""><title>Detect for chimera taxa using vsearch — chimera_detection_vs • MiscMetabar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Detect for chimera taxa using vsearch — chimera_detection_vs"><meta property="og:description" content=""><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-secondary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MiscMetabar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MiscMetabar.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Tutorials</h6>
    <a class="dropdown-item" href="../articles/import_export_track.html">Import/export and track</a>
    <a class="dropdown-item" href="../articles/explore_data.html">Explore phyloseq data</a>
    <a class="dropdown-item" href="../articles/filter.html">Filter taxa and samples</a>
    <a class="dropdown-item" href="../articles/Reclustering.html">Reclustering</a>
    <a class="dropdown-item" href="../articles/tree_visualization.html">Tree visualization</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Diversity analysis</h6>
    <a class="dropdown-item" href="../articles/alpha-div.html">Alpha-diversity</a>
    <a class="dropdown-item" href="../articles/beta-div.html">Beta-diversity</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Examples with published dataset</h6>
    <a class="dropdown-item" href="../articles/tengeler.html">Tengeler</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>R ecosystem for metabarcoding</h6>
    <a class="dropdown-item" href="../articles/states_of_fields_in_R.html">Metabarcoding with R</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>For developpers</h6>
    <a class="dropdown-item" href="../articles/Rules.html">Rules of code</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/adrientaudiere/MiscMetabar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Detect for chimera taxa using <a href="https://github.com/torognes/vsearch" class="external-link">vsearch</a></h1>
      <small class="dont-index">Source: <a href="https://github.com/adrientaudiere/MiscMetabar/blob/HEAD/R/vsearch.R" class="external-link"><code>R/vsearch.R</code></a></small>
      <div class="d-none name"><code>chimera_detection_vs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">chimera_detection_vs</span><span class="op">(</span></span>
<span>  <span class="va">seq2search</span>,</span>
<span>  <span class="va">nb_seq</span>,</span>
<span>  vsearchpath <span class="op">=</span> <span class="st">"vsearch"</span>,</span>
<span>  abskew <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  min_seq_length <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  vsearch_args <span class="op">=</span> <span class="st">"--fasta_width 0"</span>,</span>
<span>  keep_temporary_files <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>seq2search</dt>
<dd><p>(required) a list of DNA sequences coercible by function
<code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html" class="external-link">Biostrings::DNAStringSet()</a></code></p></dd>


<dt>nb_seq</dt>
<dd><p>(required) a numeric vector giving the number of sequences for
each DNA sequences</p></dd>


<dt>vsearchpath</dt>
<dd><p>(default: vsearch) path to vsearch</p></dd>


<dt>abskew</dt>
<dd><p>(int, default 2) The abundance skew is used to distinguish in a
three way alignment which sequence is the chimera and which are the
parents. The assumption is that chimeras appear later in the PCR
amplification process and are therefore less abundant than their parents.
The default value is 2.0, which means that the parents should be at least
2 times more abundant than their chimera. Any positive value equal or
greater than 1.0 can be used.</p></dd>


<dt>min_seq_length</dt>
<dd><p>(int, default 100)) Minimum length of sequences to
be part of the analysis</p></dd>


<dt>vsearch_args</dt>
<dd><p>(default "--fasta_width 0") A list of other args for
vsearch command</p></dd>


<dt>keep_temporary_files</dt>
<dd><p>(logical, default: FALSE) Do we keep temporary
files ?</p><ul><li><p>non_chimeras.fasta</p></li>
<li><p>chimeras.fasta</p></li>
<li><p>borderline.fasta</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of 3 including non-chimera taxa (<code>$non_chimera</code>), chimera taxa
(<code>$chimera</code>) and bordeline taxa (<code>$borderline</code>)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is mainly a wrapper of the work of others.
Please make <a href="https://github.com/torognes/vsearch" class="external-link">vsearch</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Adrien Taudière</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">chimera_detection_vs</span><span class="op">(</span></span></span>
<span class="r-in"><span>  seq2search <span class="op">=</span> <span class="va">data_fungi</span><span class="op">@</span><span class="va">refseq</span>,</span></span>
<span class="r-in"><span>  nb_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_sums.html" class="external-link">taxa_sums</a></span><span class="op">(</span><span class="va">data_fungi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering for sequences under 100 bp remove a total of 0 ( 0 %) unique sequences for a total of 0 sequences removed ( 0 %)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $non_chimera</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AAStringSet object of length 1051:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        width seq                                            names               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [1]   312 AAATGCGATAAGTAATGTGAAT...TAGGAATACCCGCTGAACTTA ASV1;size=92884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [2]   301 AAATGCGATAAGTAATGTGAAT...TAGGAATACCCGCTGAACTTA ASV2;size=53538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [3]   349 AAATGCGATAAGTAATGTGAAT...TGGGACTACCCGCTGAACTTA ASV3;size=47410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [4]   357 AAATGCGATAAGTAATGTGAAT...TGGGACTACCCGCTGAACTTA ASV4;size=46857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [5]   300 AAATGCGATAAGTAATGTGAAT...TAGGAATACCCGCTGAACTTA ASV5;size=41082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ...   ... ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1047]   260 AAACGCGAAAAGTGTTATGATG...AAGATCACCCGCTGAACTTAA ASV1420;size=2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1048]   365 AAATGCGATAAGTAATGTGAAT...TAGGACTACCCGCTGAACTTA ASV602;size=2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1049]   344 AAATGCGATAAGTAATGTGAAT...TAGGAATACGCGCTGAACTTA ASV1142;size=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1050]   290 GAAATGCGATAAGTAATGTGAA...TAGGGATACCCGCTGAACTTA ASV246;size=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1051]   318 GAAATGCGATACGTAATGTGAA...AGGGATACCCGCTGAACTTAA ASV412;size=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $chimera</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AAStringSet object of length 242:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       width seq                                             names               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   341 GAAATGCGATAAGTAATGTGAA...GTAGGATTACCCGCTGAACTTA ASV136;size=2743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]   307 AAATGCGATAAGTAATGTGAAT...GTAGGGATACCCGCTGAACTTA ASV163;size=2028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]   339 AAATGCGATAAGTAATGTGAAT...GTAGGATTACCCGCTGAACTTA ASV206;size=1471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]   312 AAATGCGATAAGTAATGTGAAT...GTAGGAATACCCGCTGAACTTA ASV286;size=875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]   306 AAATGCGAAAAGTAGTGTGAAT...GTAGGGATACCCGCTGAACTTA ASV294;size=832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ...   ... ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [238]   303 GAAATGCGATACTTGGTGTGAA...GTGGGACTACCCGCTGAACTTA ASV1390;size=29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [239]   293 GAACTACGATAAGTAATGTGAA...TAGGGATACCCGCTGAACTTAA ASV1395;size=25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [240]   301 AAATGCGAAAAGTAGTGTGAAT...TAGGGATACCCGCTGAACTTAA ASV1407;size=18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [241]   382 AAATGCGATAAATAATATGAAT...GCAAGATTACCCGCTGAACTTA ASV1411;size=12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [242]   287 GAAATGCGATAAGTAATGTGAA...TAGGGCTACCCGCTGAACTTAA ASV789;size=2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $borderline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AAStringSet object of length 127:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       width seq                                             names               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   344 AAATGCGATAAGTAATGTGAAT...GTAGGACTACCCGCTGAACTTA ASV74;size=5699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]   298 AAATGCGATAAGTAATGTGAAT...GTAGGGATACCCGCTGAACTTA ASV123;size=3164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]   300 AAATGCGATAAGTAATGTGAAT...GTAGGGATACCCGCTGAACTTA ASV139;size=2712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]   304 AAATGCGATAAGTAATGTGAAT...GTAGGACTACCCGCTGAACTTA ASV141;size=2611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]   295 AAATGCGATAAGTAATGTGAAT...GTAGGGATACCCGCTGAACTTA ASV153;size=2294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ...   ... ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [123]   330 AAACGCGATAGGTAATGTGAAT...GTAGGACTACCCGCTGAACTTA ASV1292;size=62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [124]   332 AAATGCGATAAGTAATGTGAAT...GTAGGAATACCCGCTGAACTTA ASV1353;size=48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [125]   300 GAAATGCGATAAGTAATGCGAA...GTAGGGATACCCGCTGAACTTA ASV1384;size=31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [126]   302 GAAATGCGATACGTAATGTGAA...TAGGAATACCCGCTGAACTTAA ASV1388;size=29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [127]   316 GAAATGCGATAAATAATATGAA...ACAAGATTACCCGCTGAACTTA ASV1399;size=22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Adrien Taudière.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

