<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Firstly release in the speedyseq R
package by Michael R. McLaren.
Merge taxa in x into a smaller set of taxa defined by the vector group.
Taxa whose value in group is NA will be dropped. New taxa will be named
according to the most abundant taxon in each group (phyloseq and
otu_table objects) or the first taxon in each group (all other phyloseq
component objects).
If x is a phyloseq object with a phylogenetic tree, then the new taxa will
be ordered as they are in the tree. Otherwise, the taxa order can be
controlled by the reorder argument, which behaves like the reorder
argument in base::rowsum(). reorder = FALSE will keep taxa in
the original order determined by when the member of each group first appears
in taxa_names(x); reorder = TRUE will order new taxa according to their
corresponding value in group.
The tax_adjust argument controls the handling of taxonomic disagreements
within groups. Setting tax_adjust == 0 causes no adjustment; the taxonomy
of the new group is set to the archetype taxon (see below). Otherwise,
disagreements within a group at a given rank cause the values at lower ranks
to be set to NA. If tax_adjust == 1 (the default), then a rank where all
taxa in the group are already NA is not counted as a disagreement, and lower
ranks may be kept if the taxa agree. This corresponds to the original
phyloseq behavior. If tax_adjust == 2, then these NAs are treated as a
disagreement; all ranks are set to NA after the first disagreement or NA."><title>Merge taxa in groups (vectorized version) — merge_taxa_vec • MiscMetabar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Merge taxa in groups (vectorized version) — merge_taxa_vec"><meta property="og:description" content="
Firstly release in the speedyseq R
package by Michael R. McLaren.
Merge taxa in x into a smaller set of taxa defined by the vector group.
Taxa whose value in group is NA will be dropped. New taxa will be named
according to the most abundant taxon in each group (phyloseq and
otu_table objects) or the first taxon in each group (all other phyloseq
component objects).
If x is a phyloseq object with a phylogenetic tree, then the new taxa will
be ordered as they are in the tree. Otherwise, the taxa order can be
controlled by the reorder argument, which behaves like the reorder
argument in base::rowsum(). reorder = FALSE will keep taxa in
the original order determined by when the member of each group first appears
in taxa_names(x); reorder = TRUE will order new taxa according to their
corresponding value in group.
The tax_adjust argument controls the handling of taxonomic disagreements
within groups. Setting tax_adjust == 0 causes no adjustment; the taxonomy
of the new group is set to the archetype taxon (see below). Otherwise,
disagreements within a group at a given rank cause the values at lower ranks
to be set to NA. If tax_adjust == 1 (the default), then a rank where all
taxa in the group are already NA is not counted as a disagreement, and lower
ranks may be kept if the taxa agree. This corresponds to the original
phyloseq behavior. If tax_adjust == 2, then these NAs are treated as a
disagreement; all ranks are set to NA after the first disagreement or NA."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-secondary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MiscMetabar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MiscMetabar.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Tutorials</h6>
    <a class="dropdown-item" href="../articles/import_export_track.html">Import/export and track</a>
    <a class="dropdown-item" href="../articles/explore_data.html">Explore phyloseq data</a>
    <a class="dropdown-item" href="../articles/filter.html">Filter taxa and samples</a>
    <a class="dropdown-item" href="../articles/Reclustering.html">Reclustering</a>
    <a class="dropdown-item" href="../articles/tree_visualization.html">Tree visualization</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Diversity analysis</h6>
    <a class="dropdown-item" href="../articles/alpha-div.html">Alpha-diversity</a>
    <a class="dropdown-item" href="../articles/beta-div.html">Beta-diversity</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Examples with published dataset</h6>
    <a class="dropdown-item" href="../articles/tengeler.html">Tengeler</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>R ecosystem for metabarcoding</h6>
    <a class="dropdown-item" href="../articles/states_of_fields_in_R.html">Metabarcoding with R</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>For developpers</h6>
    <a class="dropdown-item" href="../articles/Rules.html">Rules of code</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/adrientaudiere/MiscMetabar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Merge taxa in groups (vectorized version)</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrientaudiere/MiscMetabar/blob/HEAD/R/speedyseq_functions.R" class="external-link"><code>R/speedyseq_functions.R</code></a></small>
      <div class="d-none name"><code>merge_taxa_vec.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Firstly release in the <a href="https://github.com/mikemc/speedyseq/" class="external-link">speedyseq</a> R
package by Michael R. McLaren.</p>
<p>Merge taxa in <code>x</code> into a smaller set of taxa defined by the vector <code>group</code>.
Taxa whose value in <code>group</code> is NA will be dropped. New taxa will be named
according to the most abundant taxon in each group (<code>phyloseq</code> and
<code>otu_table</code> objects) or the first taxon in each group (all other phyloseq
component objects).</p>
<p>If <code>x</code> is a phyloseq object with a phylogenetic tree, then the new taxa will
be ordered as they are in the tree. Otherwise, the taxa order can be
controlled by the <code>reorder</code> argument, which behaves like the <code>reorder</code>
argument in <code><a href="https://rdrr.io/r/base/rowsum.html" class="external-link">base::rowsum()</a></code>. <code>reorder = FALSE</code> will keep taxa in
the original order determined by when the member of each group first appears
in <code>taxa_names(x)</code>; <code>reorder = TRUE</code> will order new taxa according to their
corresponding value in <code>group</code>.</p>
<p>The <code>tax_adjust</code> argument controls the handling of taxonomic disagreements
within groups. Setting <code>tax_adjust == 0</code> causes no adjustment; the taxonomy
of the new group is set to the archetype taxon (see below). Otherwise,
disagreements within a group at a given rank cause the values at lower ranks
to be set to <code>NA</code>. If <code>tax_adjust == 1</code> (the default), then a rank where all
taxa in the group are already NA is not counted as a disagreement, and lower
ranks may be kept if the taxa agree. This corresponds to the original
phyloseq behavior. If <code>tax_adjust == 2</code>, then these NAs are treated as a
disagreement; all ranks are set to NA after the first disagreement or NA.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">merge_taxa_vec</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, reorder <span class="op">=</span> <span class="cn">FALSE</span>, tax_adjust <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for phyloseq</span></span>
<span><span class="fu">merge_taxa_vec</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, reorder <span class="op">=</span> <span class="cn">FALSE</span>, tax_adjust <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for otu_table</span></span>
<span><span class="fu">merge_taxa_vec</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, reorder <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for taxonomyTable</span></span>
<span><span class="fu">merge_taxa_vec</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, reorder <span class="op">=</span> <span class="cn">FALSE</span>, tax_adjust <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for phylo</span></span>
<span><span class="fu">merge_taxa_vec</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for XStringSet</span></span>
<span><span class="fu">merge_taxa_vec</span><span class="op">(</span><span class="va">x</span>, <span class="va">group</span>, reorder <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A phyloseq object or component object</p></dd>


<dt>group</dt>
<dd><p>A vector with one element for each taxon in <code>physeq</code> that
defines the new groups. see <code><a href="https://rdrr.io/r/base/rowsum.html" class="external-link">base::rowsum()</a></code>.</p></dd>


<dt>reorder</dt>
<dd><p>Logical specifying whether to reorder the taxa by their
<code>group</code> values. Ignored if <code>x</code> has (or is) a phylogenetic tree.</p></dd>


<dt>tax_adjust</dt>
<dd><p>0: no adjustment; 1: phyloseq-compatible adjustment; 2:
conservative adjustment</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Function in MiscMetabar that use this function: <code><a href="asv2otu.html">asv2otu()</a></code></p>
<p><code><a href="https://rdrr.io/r/base/rowsum.html" class="external-link">base::rowsum()</a></code></p>
<p><code><a href="https://rdrr.io/pkg/phyloseq/man/merge_taxa-methods.html" class="external-link">phyloseq::merge_taxa()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael R. McLaren (orcid: <a href="https://orcid.org/0000-0003-1575-473X" class="external-link">0000-0003-1575-473X</a>) modified by Adrien Taudiere</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Adrien Taudière.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

