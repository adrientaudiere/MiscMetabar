<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Visualization of two samples for comparison — biplot_pq • MiscMetabar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Visualization of two samples for comparison — biplot_pq"><meta name="description" content="


Graphical representation of distribution of taxa across two samples."><meta property="og:description" content="


Graphical representation of distribution of taxa across two samples."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-secondary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MiscMetabar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.11.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MiscMetabar.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/import_export_track.html">Import/export and track</a></li>
    <li><a class="dropdown-item" href="../articles/explore_data.html">Explore phyloseq data</a></li>
    <li><a class="dropdown-item" href="../articles/filter.html">Filter taxa and samples</a></li>
    <li><a class="dropdown-item" href="../articles/Reclustering.html">Reclustering</a></li>
    <li><a class="dropdown-item" href="../articles/tree_visualization.html">Tree building and visualization</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Diversity analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/alpha-div.html">Alpha-diversity</a></li>
    <li><a class="dropdown-item" href="../articles/beta-div.html">Beta-diversity</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Bioinformatics actions</h6></li>
    <li><a class="dropdown-item" href="../articles/fastq_quality_check.html">Fastq quality check</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples with published dataset</h6></li>
    <li><a class="dropdown-item" href="../articles/tengeler.html">Tengeler dataset</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>R ecosystem for metabarcoding</h6></li>
    <li><a class="dropdown-item" href="../articles/states_of_fields_in_R.html">Metabarcoding with R</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For developpers</h6></li>
    <li><a class="dropdown-item" href="../articles/Rules.html">Rules of code</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrientaudiere/MiscMetabar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualization of two samples for comparison</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrientaudiere/MiscMetabar/blob/HEAD/R/plot_functions.R" class="external-link"><code>R/plot_functions.R</code></a></small>
      <div class="d-none name"><code>biplot_pq.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-maturing-blue" alt="lifecycle-maturing"></a></p>

<p>Graphical representation of distribution of taxa across two samples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">biplot_pq</span><span class="op">(</span></span>
<span>  <span class="va">physeq</span>,</span>
<span>  fact <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  merge_sample_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rarefy_after_merging <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  inverse_side <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  left_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  left_name_col <span class="op">=</span> <span class="st">"#4B3E1E"</span>,</span>
<span>  left_fill <span class="op">=</span> <span class="st">"#4B3E1E"</span>,</span>
<span>  left_col <span class="op">=</span> <span class="st">"#f3f2d9"</span>,</span>
<span>  right_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  right_name_col <span class="op">=</span> <span class="st">"#1d2949"</span>,</span>
<span>  right_fill <span class="op">=</span> <span class="st">"#1d2949"</span>,</span>
<span>  right_col <span class="op">=</span> <span class="st">"#1d2949"</span>,</span>
<span>  log10trans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nudge_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  geom_label <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  text_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  size_names <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  y_names <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ylim_modif <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  nb_samples_info <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotly_version <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-physeq">physeq<a class="anchor" aria-label="anchor" href="#arg-physeq"></a></dt>
<dd><p>(required): a <code><a href="https://rdrr.io/pkg/phyloseq/man/phyloseq-class.html" class="external-link">phyloseq-class</a></code> object obtained
using the <code>phyloseq</code> package.</p></dd>


<dt id="arg-fact">fact<a class="anchor" aria-label="anchor" href="#arg-fact"></a></dt>
<dd><p>(default: NULL) Name of the factor in <code>physeq@sam_data</code>.
If left to NULL use the <code>left_name</code> and <code>right_name</code> parameter as modality.</p></dd>


<dt id="arg-merge-sample-by">merge_sample_by<a class="anchor" aria-label="anchor" href="#arg-merge-sample-by"></a></dt>
<dd><p>(default: NULL) if not <code>NULL</code> samples of
physeq are merged using the vector set by <code>merge_sample_by</code>. This
merging used the <code><a href="merge_samples2.html">merge_samples2()</a></code>. In the case of
<code>biplot_pq()</code> this must be a factor with two levels only.</p></dd>


<dt id="arg-rarefy-after-merging">rarefy_after_merging<a class="anchor" aria-label="anchor" href="#arg-rarefy-after-merging"></a></dt>
<dd><p>Rarefy each sample after merging by the
modalities merge_sample_by</p></dd>


<dt id="arg-inverse-side">inverse_side<a class="anchor" aria-label="anchor" href="#arg-inverse-side"></a></dt>
<dd><p>Inverse the side (put the right modality in the left side).</p></dd>


<dt id="arg-left-name">left_name<a class="anchor" aria-label="anchor" href="#arg-left-name"></a></dt>
<dd><p>Name fo the left sample.</p></dd>


<dt id="arg-left-name-col">left_name_col<a class="anchor" aria-label="anchor" href="#arg-left-name-col"></a></dt>
<dd><p>Color for the left name</p></dd>


<dt id="arg-left-fill">left_fill<a class="anchor" aria-label="anchor" href="#arg-left-fill"></a></dt>
<dd><p>Fill fo the left sample.</p></dd>


<dt id="arg-left-col">left_col<a class="anchor" aria-label="anchor" href="#arg-left-col"></a></dt>
<dd><p>Color fo the left sample.</p></dd>


<dt id="arg-right-name">right_name<a class="anchor" aria-label="anchor" href="#arg-right-name"></a></dt>
<dd><p>Name fo the right sample.</p></dd>


<dt id="arg-right-name-col">right_name_col<a class="anchor" aria-label="anchor" href="#arg-right-name-col"></a></dt>
<dd><p>Color for the right name</p></dd>


<dt id="arg-right-fill">right_fill<a class="anchor" aria-label="anchor" href="#arg-right-fill"></a></dt>
<dd><p>Fill fo the right sample.</p></dd>


<dt id="arg-right-col">right_col<a class="anchor" aria-label="anchor" href="#arg-right-col"></a></dt>
<dd><p>Color fo the right sample.</p></dd>


<dt id="arg-log-trans">log10trans<a class="anchor" aria-label="anchor" href="#arg-log-trans"></a></dt>
<dd><p>(logical) Does abundancy is log10 transformed ?</p></dd>


<dt id="arg-nudge-y">nudge_y<a class="anchor" aria-label="anchor" href="#arg-nudge-y"></a></dt>
<dd><p>A parameter to control the y position of abundancy values.
If a vector of two values are set. The first value is for the left side.
and the second value for the right one. If one value is set,
this value is used for both side.</p></dd>


<dt id="arg-geom-label">geom_label<a class="anchor" aria-label="anchor" href="#arg-geom-label"></a></dt>
<dd><p>(default: FALSE, logical) if TRUE use the <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_label()</a></code> function
instead of <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code> to indicate the numbers of sequences.</p></dd>


<dt id="arg-text-size">text_size<a class="anchor" aria-label="anchor" href="#arg-text-size"></a></dt>
<dd><p>size for the number of sequences</p></dd>


<dt id="arg-size-names">size_names<a class="anchor" aria-label="anchor" href="#arg-size-names"></a></dt>
<dd><p>size for the names of the 2 samples</p></dd>


<dt id="arg-y-names">y_names<a class="anchor" aria-label="anchor" href="#arg-y-names"></a></dt>
<dd><p>y position for the names of the 2 samples. If NA (default),
computed using the maximum abundances values.</p></dd>


<dt id="arg-ylim-modif">ylim_modif<a class="anchor" aria-label="anchor" href="#arg-ylim-modif"></a></dt>
<dd><p>vector of two values. Modificator (by a multiplication)
of ylim. If one value is set, this value is used for both limits.</p></dd>


<dt id="arg-nb-samples-info">nb_samples_info<a class="anchor" aria-label="anchor" href="#arg-nb-samples-info"></a></dt>
<dd><p>(default: TRUE, logical) if TRUE and merge_sample_by is set,
add the number of samples merged for both levels.</p></dd>


<dt id="arg-plotly-version">plotly_version<a class="anchor" aria-label="anchor" href="#arg-plotly-version"></a></dt>
<dd><p>If TRUE, use <code><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">plotly::ggplotly()</a></code> to return
a interactive ggplot.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments for the ggplot function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A plot</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Adrien Taudière</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data_fungi_2Height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html" class="external-link">subset_samples</a></span><span class="op">(</span><span class="va">data_fungi_mini</span>, <span class="va">Height</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"High"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">biplot_pq</span><span class="op">(</span><span class="va">data_fungi_2Height</span>, <span class="st">"Height"</span>, merge_sample_by <span class="op">=</span> <span class="st">"Height"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cleaning suppress 5 taxa and 0 samples.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">y</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">y</span>, which will replace the existing scale.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 1 row containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_rect()`).</span>
<span class="r-plt img"><img src="biplot_pq-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrien Taudière.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

