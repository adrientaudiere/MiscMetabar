<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Automated model selection and multimodel inference with (G)LMs for phyloseq — glmutli_pq • MiscMetabar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Automated model selection and multimodel inference with (G)LMs for phyloseq — glmutli_pq"><meta name="description" content="


See glmulti::glmulti() for more information."><meta property="og:description" content="


See glmulti::glmulti() for more information."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-secondary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MiscMetabar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.12.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MiscMetabar.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/import_export_track.html">Import/export and track</a></li>
    <li><a class="dropdown-item" href="../articles/explore_data.html">Explore phyloseq data</a></li>
    <li><a class="dropdown-item" href="../articles/filter.html">Filter taxa and samples</a></li>
    <li><a class="dropdown-item" href="../articles/Reclustering.html">Reclustering</a></li>
    <li><a class="dropdown-item" href="../articles/tree_visualization.html">Tree building and visualization</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Diversity analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/alpha-div.html">Alpha-diversity</a></li>
    <li><a class="dropdown-item" href="../articles/beta-div.html">Beta-diversity</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Bioinformatics actions</h6></li>
    <li><a class="dropdown-item" href="../articles/fastq_quality_check.html">Fastq quality check</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples with published dataset</h6></li>
    <li><a class="dropdown-item" href="../articles/tengeler.html">Tengeler dataset</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>R ecosystem for metabarcoding</h6></li>
    <li><a class="dropdown-item" href="../articles/states_of_fields_in_R.html">Metabarcoding with R</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For developpers</h6></li>
    <li><a class="dropdown-item" href="../articles/Rules.html">Rules of code</a></li>
    <li><a class="dropdown-item" href="../articles/pkgnet-report.html">Report pkgnet</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrientaudiere/MiscMetabar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Automated model selection and multimodel inference with (G)LMs for phyloseq</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrientaudiere/MiscMetabar/blob/HEAD/R/alpha_div_test.R" class="external-link"><code>R/alpha_div_test.R</code></a></small>
      <div class="d-none name"><code>glmutli_pq.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a></p>

<p>See <code><a href="https://rdrr.io/pkg/glmulti/man/glmulti.html" class="external-link">glmulti::glmulti()</a></code> for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">glmutli_pq</span><span class="op">(</span></span>
<span>  <span class="va">physeq</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  fitfunction <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  hill_scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  aic_step <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  confsetsize <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  plotty <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"h"</span>,</span>
<span>  crit <span class="op">=</span> <span class="st">"aicc"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-physeq">physeq<a class="anchor" aria-label="anchor" href="#arg-physeq"></a></dt>
<dd><p>(required): a <code><a href="https://rdrr.io/pkg/phyloseq/man/phyloseq-class.html" class="external-link">phyloseq-class</a></code> object obtained
using the <code>phyloseq</code> package.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>(required) a formula for <code><a href="https://rdrr.io/pkg/glmulti/man/glmulti.html" class="external-link">glmulti::glmulti()</a></code>
Variables must be present in the <code>physeq@sam_data</code> slot or be one
of hill number defined in hill_scales or the variable Abundance which
refer to the number of sequences per sample.</p></dd>


<dt id="arg-fitfunction">fitfunction<a class="anchor" aria-label="anchor" href="#arg-fitfunction"></a></dt>
<dd><p>(default "lm")</p></dd>


<dt id="arg-hill-scales">hill_scales<a class="anchor" aria-label="anchor" href="#arg-hill-scales"></a></dt>
<dd><p>(a vector of integer) The list of q values to compute
the hill number H^q. If Null, no hill number are computed. Default value
compute the Hill number 0 (Species richness), the Hill number 1
(exponential of Shannon Index) and the Hill number 2 (inverse of Simpson
Index).</p></dd>


<dt id="arg-aic-step">aic_step<a class="anchor" aria-label="anchor" href="#arg-aic-step"></a></dt>
<dd><p>The value between AIC scores to cut for.</p></dd>


<dt id="arg-confsetsize">confsetsize<a class="anchor" aria-label="anchor" href="#arg-confsetsize"></a></dt>
<dd><p>The number of models to be looked for, i.e. the size of the returned confidence set.</p></dd>


<dt id="arg-plotty">plotty<a class="anchor" aria-label="anchor" href="#arg-plotty"></a></dt>
<dd><p>(logical) Whether to plot the progress of the IC profile when running.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>If 1, only main effects (terms of order 1) are used to build
the candidate set. If 2, pairwise interactions are also used (higher order
interactions are currently ignored)</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The method to be used to explore the candidate set of models.
If "h" (default) an exhaustive screening is undertaken.
If "g" the genetic algorithm is employed (recommended for large candidate sets).
If "l", a very fast exhaustive branch-and-bound algorithm is used.
Package leaps must then be loaded, and this can only be applied to linear models
with covariates and no interactions. If "d", a simple summary of the candidate set
is printed, including the number of candidate models.</p></dd>


<dt id="arg-crit">crit<a class="anchor" aria-label="anchor" href="#arg-crit"></a></dt>
<dd><p>The Information Criterion to be used. Default is the small-sample corrected AIC (aicc).
This should be a function that accepts a fitted model as first argument.
Other provided functions are the classic AIC, the Bayes IC (bic), and QAIC/QAICc (qaic and qaicc).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed on to <code><a href="https://rdrr.io/pkg/glmulti/man/glmulti.html" class="external-link">glmulti::glmulti()</a></code> function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame summarizing the glmulti results with columns</p>
<p>-estimates
-unconditional_interval
-nb_model"
-importance
-alpha</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is mainly a wrapper of the work of others.
Please make a reference to <code><a href="https://rdrr.io/pkg/glmulti/man/glmulti.html" class="external-link">glmulti::glmulti()</a></code> if you
use this function.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/glmulti/man/glmulti.html" class="external-link">glmulti::glmulti()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"glmulti"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">res_glmulti</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">glmutli_pq</span><span class="op">(</span><span class="va">data_fungi</span>, <span class="st">"Hill_0 ~ Hill_1 + Abundance + Time + Height"</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res_glmulti</span></span></span>
<span class="r-in"><span>  <span class="va">res_glmulti_interaction</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">glmutli_pq</span><span class="op">(</span><span class="va">data_fungi</span>, <span class="st">"Hill_0 ~ Abundance + Time + Height"</span>, level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">res_glmulti</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Taxa are now in rows.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Sample)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialization...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TASK: Exhaustive screening of candidate set.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Completed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Taxa are now in rows.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Sample)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initialization...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TASK: Exhaustive screening of candidate set.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> After 50 models:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best model: Hill_0~1+Abundance+Time+Time:Abundance+Height:Abundance+Height:Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Crit= 1069.11608982306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean crit= 1218.19009955263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Completed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                estimates unconditional_interval nb_model importance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hill_1       3.062117997           1.868174e-01        8          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abundance    0.002959644           8.478374e-08        8          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time         0.789091999           2.443263e-01        8          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HeightLow    6.884340946           3.444196e+01        8          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HeightMiddle 0.339123798           3.727962e+01        8          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     alpha     variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hill_1       8.570200e-01       Hill_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Abundance    5.773492e-04    Abundance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time         9.800932e-01         Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HeightLow    1.163660e+01    HeightLow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HeightMiddle 1.210648e+01 HeightMiddle</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrien Taudière.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

