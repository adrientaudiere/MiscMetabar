<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Detect for chimera taxa using vsearch — chimera_detection_vs • MiscMetabar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Detect for chimera taxa using vsearch — chimera_detection_vs"><meta name="description" content="


Use the VSEARCH software."><meta property="og:description" content="


Use the VSEARCH software."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-secondary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MiscMetabar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.13.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MiscMetabar.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/import_export_track.html">Import/export and track</a></li>
    <li><a class="dropdown-item" href="../articles/explore_data.html">Explore phyloseq data</a></li>
    <li><a class="dropdown-item" href="../articles/filter.html">Filter taxa and samples</a></li>
    <li><a class="dropdown-item" href="../articles/Reclustering.html">Reclustering</a></li>
    <li><a class="dropdown-item" href="../articles/tree_visualization.html">Tree building and visualization</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Diversity analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/alpha-div.html">Alpha-diversity</a></li>
    <li><a class="dropdown-item" href="../articles/beta-div.html">Beta-diversity</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Bioinformatics actions</h6></li>
    <li><a class="dropdown-item" href="../articles/fastq_quality_check.html">Fastq quality check</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples with published dataset</h6></li>
    <li><a class="dropdown-item" href="../articles/tengeler.html">Tengeler dataset</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>R ecosystem for metabarcoding</h6></li>
    <li><a class="dropdown-item" href="../articles/states_of_fields_in_R.html">Metabarcoding with R</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For developpers</h6></li>
    <li><a class="dropdown-item" href="../articles/Rules.html">Rules of code</a></li>
    <li><a class="dropdown-item" href="../articles/pkgnet-report.html">Report pkgnet</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrientaudiere/MiscMetabar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Detect for chimera taxa using <a href="https://github.com/torognes/vsearch" class="external-link">vsearch</a></h1>
      <small class="dont-index">Source: <a href="https://github.com/adrientaudiere/MiscMetabar/blob/HEAD/R/vsearch.R" class="external-link"><code>R/vsearch.R</code></a></small>
      <div class="d-none name"><code>chimera_detection_vs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://adrientaudiere.github.io/MiscMetabar/articles/Rules.html#lifecycle">
<img src="https://img.shields.io/badge/lifecycle-experimental-orange" alt="lifecycle-experimental"></a></p>

<p>Use the VSEARCH software.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">chimera_detection_vs</span><span class="op">(</span></span>
<span>  <span class="va">seq2search</span>,</span>
<span>  <span class="va">nb_seq</span>,</span>
<span>  vsearchpath <span class="op">=</span> <span class="st">"vsearch"</span>,</span>
<span>  abskew <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  min_seq_length <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  vsearch_args <span class="op">=</span> <span class="st">"--fasta_width 0"</span>,</span>
<span>  keep_temporary_files <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-seq-search">seq2search<a class="anchor" aria-label="anchor" href="#arg-seq-search"></a></dt>
<dd><p>(required) a list of DNA sequences coercible by function
<code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html" class="external-link">Biostrings::DNAStringSet()</a></code></p></dd>


<dt id="arg-nb-seq">nb_seq<a class="anchor" aria-label="anchor" href="#arg-nb-seq"></a></dt>
<dd><p>(required) a numeric vector giving the number of sequences for
each DNA sequences</p></dd>


<dt id="arg-vsearchpath">vsearchpath<a class="anchor" aria-label="anchor" href="#arg-vsearchpath"></a></dt>
<dd><p>(default: "vsearch") path to vsearch</p></dd>


<dt id="arg-abskew">abskew<a class="anchor" aria-label="anchor" href="#arg-abskew"></a></dt>
<dd><p>(int, default 2) The abundance skew is used to distinguish in a
three way alignment which sequence is the chimera and which are the
parents. The assumption is that chimeras appear later in the PCR
amplification process and are therefore less abundant than their parents.
The default value is 2.0, which means that the parents should be at least
2 times more abundant than their chimera. Any positive value equal or
greater than 1.0 can be used.</p></dd>


<dt id="arg-min-seq-length">min_seq_length<a class="anchor" aria-label="anchor" href="#arg-min-seq-length"></a></dt>
<dd><p>(int, default 100)) Minimum length of sequences to
be part of the analysis</p></dd>


<dt id="arg-vsearch-args">vsearch_args<a class="anchor" aria-label="anchor" href="#arg-vsearch-args"></a></dt>
<dd><p>(default "–fasta_width 0") A list of other args for
vsearch command</p></dd>


<dt id="arg-keep-temporary-files">keep_temporary_files<a class="anchor" aria-label="anchor" href="#arg-keep-temporary-files"></a></dt>
<dd><p>(logical, default: FALSE) Do we keep temporary
files ?</p><ul><li><p>non_chimeras.fasta</p></li>
<li><p>chimeras.fasta</p></li>
<li><p>borderline.fasta</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of 3 including non-chimera taxa (<code>$non_chimera</code>), chimera taxa
(<code>$chimera</code>) and bordeline taxa (<code>$borderline</code>)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is mainly a wrapper of the work of others.
Please make <a href="https://github.com/torognes/vsearch" class="external-link">vsearch</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="chimera_removal_vs.html">chimera_removal_vs()</a></code>, <code><a href="https://rdrr.io/pkg/dada2/man/removeBimeraDenovo.html" class="external-link">dada2::removeBimeraDenovo()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Adrien Taudière</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu">chimera_detection_vs</span><span class="op">(</span></span></span>
<span class="r-in"><span>  seq2search <span class="op">=</span> <span class="va">data_fungi</span><span class="op">@</span><span class="va">refseq</span>,</span></span>
<span class="r-in"><span>  nb_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_sums.html" class="external-link">taxa_sums</a></span><span class="op">(</span><span class="va">data_fungi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering for sequences under 100 bp remove a total of 0 ( 0 %) unique sequences for a total of 0 sequences removed ( 0 %)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $non_chimera</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AAStringSet object of length 1088:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        width seq                                            names               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [1]   312 AAATGCGATAAGTAATGTGAAT...TAGGAATACCCGCTGAACTTA Taxa1;size=92884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [2]   301 AAATGCGATAAGTAATGTGAAT...TAGGAATACCCGCTGAACTTA Taxa2;size=53538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [3]   349 AAATGCGATAAGTAATGTGAAT...TGGGACTACCCGCTGAACTTA Taxa3;size=47410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [4]   357 AAATGCGATAAGTAATGTGAAT...TGGGACTACCCGCTGAACTTA Taxa4;size=46857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [5]   300 AAATGCGATAAGTAATGTGAAT...TAGGAATACCCGCTGAACTTA Taxa5;size=41082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ...   ... ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1084]   260 AAACGCGAAAAGTGTTATGATG...AAGATCACCCGCTGAACTTAA Taxa1420;size=2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1085]   365 AAATGCGATAAGTAATGTGAAT...TAGGACTACCCGCTGAACTTA Taxa602;size=2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1086]   344 AAATGCGATAAGTAATGTGAAT...TAGGAATACGCGCTGAACTTA Taxa1142;size=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1087]   290 GAAATGCGATAAGTAATGTGAA...TAGGGATACCCGCTGAACTTA Taxa246;size=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1088]   318 GAAATGCGATACGTAATGTGAA...AGGGATACCCGCTGAACTTAA Taxa412;size=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $chimera</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AAStringSet object of length 220:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       width seq                                             names               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   341 GAAATGCGATAAGTAATGTGAA...GTAGGATTACCCGCTGAACTTA Taxa136;size=2743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]   307 AAATGCGATAAGTAATGTGAAT...GTAGGGATACCCGCTGAACTTA Taxa163;size=2028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]   339 AAATGCGATAAGTAATGTGAAT...GTAGGATTACCCGCTGAACTTA Taxa206;size=1471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]   312 AAATGCGATAAGTAATGTGAAT...GTAGGAATACCCGCTGAACTTA Taxa286;size=875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]   306 AAATGCGAAAAGTAGTGTGAAT...GTAGGGATACCCGCTGAACTTA Taxa294;size=832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ...   ... ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [216]   296 AAATGCGATACTTGGTGTGAAT...GTAGGGATACCCGCTGAACTTA Taxa1386;size=30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [217]   287 AAATGCGATAAGTAATATGAAT...GTAGGGATACCCGCTGAACTTA Taxa1389;size=29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [218]   293 GAACTACGATAAGTAATGTGAA...TAGGGATACCCGCTGAACTTAA Taxa1395;size=25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [219]   382 AAATGCGATAAATAATATGAAT...GCAAGATTACCCGCTGAACTTA Taxa1411;size=12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [220]   287 GAAATGCGATAAGTAATGTGAA...TAGGGCTACCCGCTGAACTTAA Taxa789;size=2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $borderline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AAStringSet object of length 112:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       width seq                                             names               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]   298 AAATGCGATAAGTAATGTGAAT...GTAGGGATACCCGCTGAACTTA Taxa123;size=3164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]   300 AAATGCGATAAGTAATGTGAAT...GTAGGGATACCCGCTGAACTTA Taxa139;size=2712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]   295 AAATGCGATAAGTAATGTGAAT...GTAGGGATACCCGCTGAACTTA Taxa153;size=2294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]   302 AAATGCGATAAGTAATGTGAAT...GTAGGGATACCCGCTGAACTTA Taxa174;size=1851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]   383 AAATGCGATAAGTAATGTGAAT...GTGGGACTACCCGCTGAACTTA Taxa177;size=1814</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ...   ... ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [108]   332 AAATGCGATAAGTAATGTGAAT...GTAGGAATACCCGCTGAACTTA Taxa1353;size=48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [109]   313 AAATGCGATAAGTAGTGTGAAT...TAGGAATACCCGCTGAACTTAA Taxa1354;size=48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [110]   300 GAAATGCGATAAGTAATGCGAA...GTAGGGATACCCGCTGAACTTA Taxa1384;size=31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [111]   302 GAAATGCGATACGTAATGTGAA...TAGGAATACCCGCTGAACTTAA Taxa1388;size=29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [112]   316 GAAATGCGATAAATAATATGAA...ACAAGATTACCCGCTGAACTTA Taxa1399;size=22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrien Taudière.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

